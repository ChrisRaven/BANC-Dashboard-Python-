from caveclient import CAVEclient
from datetime import datetime, timezone

def get_synaptic_partners(source_ids):
  client = CAVEclient(datastack_name = 'brain_and_nerve_cord')

  source_ids = [
      720575941662397564,720575941642728530,720575941448136117,720575941522277963,720575941533955818,720575941604757664,720575941514374659,720575941504574629,720575941599042089,720575941569293246,720575941431191822,720575941517153964,720575941538599549,720575941593448999,720575941686633228,720575941540852060,720575941483718029,720575941529379787,720575941557368766,720575941430035809,720575941481298429,720575941593621287,720575941482387965,720575941404451612,720575941555752228,720575941495031680,720575941539099005,720575941721341242,720575941569337790,720575941569493950,720575941591889259,720575941497597665,720575941581215314,720575941462664887,720575941519559478,720575941613649049,720575941536100318,720575941338817903,720575941605725549,720575941423225519,720575941554124115,720575941598141384,720575941375230689,720575941221328236,720575941530054091,720575941558506990,720575941494279674,720575941479454799,720575941569432766,720575941443216810
  ]

  ids = client.materialize.synapse_query(pre_ids=source_ids)
  print('done')
  ids.to_clipboard(index=False, header=False, columns=['post_pt_root_id'], sep=',')
  return ids


